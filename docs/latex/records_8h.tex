\hypertarget{records_8h}{}\section{records.\+h File Reference}
\label{records_8h}\index{records.\+h@{records.\+h}}


Data structures (and macros) that comprise the database index.  


\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}}
\begin{DoxyCompactList}\small\item\em Holds information relating to a bucket ({\itshape key}), including the number of pages allocated, as well as a pointer to those pages in memory. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structkv__record}{kv\+\_\+record}}
\begin{DoxyCompactList}\small\item\em Holds information for a key/value pair, including the bucket the value resides in, it\textquotesingle{}s {\itshape index} (offset) into the bucket (\mbox{\hyperlink{structptbl__record_acec45fcdf4427d3a1b62c84973d5f484}{ptbl\+\_\+record.\+m\+\_\+offset}} + {\itshape index}), in addition to the size of the value in bytes. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structdatabase__record}{database\+\_\+record}}
\begin{DoxyCompactList}\small\item\em Holds the global state of the database. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{records_8h_abcc7cb7701a27ad791d23f88ce3fa2c3}{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+L\+E\+N\+G\+TH}}(x,  y)
\begin{DoxyCompactList}\small\item\em Calculate bytes used by multiple pages bookkeeping. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_a1cd95048f707ae0b6b39835a9a375f80}{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+B\+Y\+T\+ES}}(x)~((x $<$ 5) ? (32 $>$$>$ x) \+: 1)
\begin{DoxyCompactList}\small\item\em Calculate bytes used by one pages bookkeeping. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_a46f2b82d234b9778310024626d19fb03}{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+B\+I\+TS}}(x)~((x $<$ 8) ? (256 $>$$>$ x) \+: 1)
\begin{DoxyCompactList}\small\item\em Calculate bits used by one page\textquotesingle{}s bookkeeping. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_ab49380468cb45feb3cc044c7337b5e7c}{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+W\+O\+R\+D\+\_\+\+S\+I\+ZE}}(x)~(16 $<$$<$ x)
\begin{DoxyCompactList}\small\item\em Calculate max value size for bucket {\itshape x}. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{records_8h_a4307b32adc58d4d466f48cb0ca739624}\label{records_8h_a4307b32adc58d4d466f48cb0ca739624}} 
\#define \mbox{\hyperlink{records_8h_a4307b32adc58d4d466f48cb0ca739624}{P\+T\+B\+L\+\_\+\+K\+E\+Y\+\_\+\+B\+I\+T\+M\+A\+SK}}~(0x\+E0 $<$$<$ 24)
\begin{DoxyCompactList}\small\item\em Used for selecting the uppermost three bits of a 32-\/bit integer. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{records_8h_a17dbe31d1cee6f44a3bad7897ef979bf}\label{records_8h_a17dbe31d1cee6f44a3bad7897ef979bf}} 
\#define \mbox{\hyperlink{records_8h_a17dbe31d1cee6f44a3bad7897ef979bf}{P\+T\+B\+L\+\_\+\+K\+E\+Y\+\_\+\+H\+I\+G\+H\+\_\+\+B\+I\+T\+M\+A\+SK}}~0x38
\begin{DoxyCompactList}\small\item\em Upper three bits. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{records_8h_af01d8b6e79fbdd4889e8fc15c72c153b}\label{records_8h_af01d8b6e79fbdd4889e8fc15c72c153b}} 
\#define \mbox{\hyperlink{records_8h_af01d8b6e79fbdd4889e8fc15c72c153b}{P\+T\+B\+L\+\_\+\+K\+E\+Y\+\_\+\+L\+O\+W\+\_\+\+B\+I\+T\+M\+A\+SK}}~0x7
\begin{DoxyCompactList}\small\item\em Lower three bits. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{records_8h_af847dfd35edd975e85b6a90d795f6f34}\label{records_8h_af847dfd35edd975e85b6a90d795f6f34}} 
\#define \mbox{\hyperlink{records_8h_af847dfd35edd975e85b6a90d795f6f34}{P\+T\+B\+L\+\_\+\+K\+E\+Y\+\_\+\+H\+I\+G\+H\+\_\+\+S\+H\+I\+FT}}~26
\begin{DoxyCompactList}\small\item\em Amount to shift the bits in \mbox{\hyperlink{structptbl__record_a34c3fcdd6600f21e6708955bc93195d6}{ptbl\+\_\+record.\+key\+\_\+high\+\_\+and\+\_\+page\+\_\+count}} right by to get the uppermost three bits of {\itshape key}. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{records_8h_a4d90c2cd7e45496cdae365da72106579}\label{records_8h_a4d90c2cd7e45496cdae365da72106579}} 
\#define \mbox{\hyperlink{records_8h_a4d90c2cd7e45496cdae365da72106579}{P\+T\+B\+L\+\_\+\+K\+E\+Y\+\_\+\+L\+O\+W\+\_\+\+S\+H\+I\+FT}}~29
\begin{DoxyCompactList}\small\item\em Amount to shift the bits in \mbox{\hyperlink{structptbl__record_a50bac56284cd6f4e527a322e07d28772}{ptbl\+\_\+record.\+key\+\_\+low\+\_\+and\+\_\+offset}} right by to get the lowermost three bits of {\itshape key}. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_a647e71e3027f3c991be8fcd4f60bf2d2}{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+P\+A\+G\+E\+\_\+\+C\+O\+U\+NT}}(x)~(x.\+key\+\_\+high\+\_\+and\+\_\+page\+\_\+count \& $\sim$\mbox{\hyperlink{records_8h_a4307b32adc58d4d466f48cb0ca739624}{P\+T\+B\+L\+\_\+\+K\+E\+Y\+\_\+\+B\+I\+T\+M\+A\+SK}})
\begin{DoxyCompactList}\small\item\em Get {\itshape page\+\_\+count} from a \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}}. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_a0fcde3739a73415bcfbc2812ad7923c5}{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+P\+A\+G\+E\+\_\+\+C\+O\+U\+NT}}(x,  y)
\begin{DoxyCompactList}\small\item\em Set {\itshape page\+\_\+count} in a \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}}. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_ac9930081aa81ff02727b678b745d0316}{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+O\+F\+F\+S\+ET}}(x)~(x.\+key\+\_\+low\+\_\+and\+\_\+offset \& $\sim$\mbox{\hyperlink{records_8h_a4307b32adc58d4d466f48cb0ca739624}{P\+T\+B\+L\+\_\+\+K\+E\+Y\+\_\+\+B\+I\+T\+M\+A\+SK}})
\begin{DoxyCompactList}\small\item\em Get {\itshape offset} from a \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}}. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_afdc13ecd37c36af6dc8f095c5575cc57}{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+O\+F\+F\+S\+ET}}(x,  y)
\begin{DoxyCompactList}\small\item\em Set {\itshape offset} in a \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}}. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_a8e35710be790a9afaebb611c8961e902}{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+K\+EY}}(x)~(((x.\+key\+\_\+high\+\_\+and\+\_\+page\+\_\+count \& \mbox{\hyperlink{records_8h_a4307b32adc58d4d466f48cb0ca739624}{P\+T\+B\+L\+\_\+\+K\+E\+Y\+\_\+\+B\+I\+T\+M\+A\+SK}}) $>$$>$ \mbox{\hyperlink{records_8h_af847dfd35edd975e85b6a90d795f6f34}{P\+T\+B\+L\+\_\+\+K\+E\+Y\+\_\+\+H\+I\+G\+H\+\_\+\+S\+H\+I\+FT}}) $\vert$ ((x.\+key\+\_\+low\+\_\+and\+\_\+offset \& \mbox{\hyperlink{records_8h_a4307b32adc58d4d466f48cb0ca739624}{P\+T\+B\+L\+\_\+\+K\+E\+Y\+\_\+\+B\+I\+T\+M\+A\+SK}}) $>$$>$ \mbox{\hyperlink{records_8h_a4d90c2cd7e45496cdae365da72106579}{P\+T\+B\+L\+\_\+\+K\+E\+Y\+\_\+\+L\+O\+W\+\_\+\+S\+H\+I\+FT}}))
\begin{DoxyCompactList}\small\item\em Get {\itshape key} from a \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}}. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_ad9320ecf8a9235a6c89f644e7fbc9b38}{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+K\+EY}}(x,  y)
\begin{DoxyCompactList}\small\item\em Set {\itshape key} in a \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}}. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_ab1ba341a9a6bebf5f1c883876fe6943a}{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+F\+R\+EE}}(x,  y,  z)~(x)-\/$>$ptbl\+\_\+record\+\_\+tbl\mbox{[}y\mbox{]}.page\+\_\+usage\mbox{[}z / 8\mbox{]} \&= $\sim$((unsigned char)1 $<$$<$ (z \% 8));
\begin{DoxyCompactList}\small\item\em Mark page number {\itshape z} as freed in \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}} at index {\itshape y} of \mbox{\hyperlink{structdatabase__record}{database\+\_\+record}} {\itshape x}. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_af3d07908f3a0accb47c36c0c34b53f40}{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+V\+A\+L\+U\+E\+\_\+\+P\+TR}}(x,  y,  z)~(unsigned char $\ast$)(x-\/$>$ptbl\+\_\+record\+\_\+tbl\mbox{[}y\mbox{]}.m\+\_\+offset + \mbox{\hyperlink{records_8h_a6889537ca98023db3031819f454673c5}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+I\+N\+D\+EX}}(z) $\ast$ \mbox{\hyperlink{records_8h_ab49380468cb45feb3cc044c7337b5e7c}{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+W\+O\+R\+D\+\_\+\+S\+I\+ZE}}(\mbox{\hyperlink{records_8h_a80448b087f4397d78cb18e87a4c03875}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+B\+U\+C\+K\+ET}}(z)))
\begin{DoxyCompactList}\small\item\em Calculate the address in memory that a given \mbox{\hyperlink{structkv__record}{kv\+\_\+record}} value resides at. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{records_8h_a0554ee6db70190ff5cfadd564a5dc340}\label{records_8h_a0554ee6db70190ff5cfadd564a5dc340}} 
\#define \mbox{\hyperlink{records_8h_a0554ee6db70190ff5cfadd564a5dc340}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+S\+H\+I\+FT}}~58
\begin{DoxyCompactList}\small\item\em Amount to shift {\itshape bucket\+\_\+and\+\_\+index} right by to extract {\itshape bucket}. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{records_8h_a87994a627b1eb53ef23a3f2e0b412dd9}\label{records_8h_a87994a627b1eb53ef23a3f2e0b412dd9}} 
\#define \mbox{\hyperlink{records_8h_a87994a627b1eb53ef23a3f2e0b412dd9}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+B\+I\+T\+M\+A\+SK}}~((unsigned long)0x3\+F $<$$<$ K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+S\+H\+I\+F\+T)
\begin{DoxyCompactList}\small\item\em To select the upper six bits. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_a80448b087f4397d78cb18e87a4c03875}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+B\+U\+C\+K\+ET}}(x)~(((x).bucket\+\_\+and\+\_\+index \& \mbox{\hyperlink{records_8h_a87994a627b1eb53ef23a3f2e0b412dd9}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+B\+I\+T\+M\+A\+SK}}) $>$$>$ \mbox{\hyperlink{records_8h_a0554ee6db70190ff5cfadd564a5dc340}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+S\+H\+I\+FT}})
\begin{DoxyCompactList}\small\item\em Get {\itshape bucket} from a \mbox{\hyperlink{structkv__record}{kv\+\_\+record}} pointer. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_a18d200962bc69924d436b8e8c224c6fb}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+B\+U\+C\+K\+ET}}(x,  y)
\begin{DoxyCompactList}\small\item\em Set {\itshape bucket} in a \mbox{\hyperlink{structkv__record}{kv\+\_\+record}}. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_a6889537ca98023db3031819f454673c5}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+I\+N\+D\+EX}}(x)~((x).bucket\+\_\+and\+\_\+index \& $\sim$\mbox{\hyperlink{records_8h_a87994a627b1eb53ef23a3f2e0b412dd9}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+B\+I\+T\+M\+A\+SK}})
\begin{DoxyCompactList}\small\item\em Get {\itshape index} from a \mbox{\hyperlink{structkv__record}{kv\+\_\+record}} pointer. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_adae07bcfb40a4d18850231371ec6204e}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+I\+N\+D\+EX}}(x,  y)
\begin{DoxyCompactList}\small\item\em Set {\itshape index} in a \mbox{\hyperlink{structkv__record}{kv\+\_\+record}}. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{records_8h_a07e560612b4c80586a58d887735f73f6}\label{records_8h_a07e560612b4c80586a58d887735f73f6}} 
\#define \mbox{\hyperlink{records_8h_a07e560612b4c80586a58d887735f73f6}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+F\+L\+A\+G\+S\+\_\+\+S\+H\+I\+FT}}~56
\begin{DoxyCompactList}\small\item\em Amount to shift {\itshape flags\+\_\+and\+\_\+size} right by to extract {\itshape flags}. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{records_8h_a240121903a439f00fd7db58a87dd6bb1}\label{records_8h_a240121903a439f00fd7db58a87dd6bb1}} 
\#define \mbox{\hyperlink{records_8h_a240121903a439f00fd7db58a87dd6bb1}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+F\+L\+A\+G\+S\+\_\+\+B\+I\+T\+M\+A\+SK}}~((unsigned long)0x\+F\+F $<$$<$ K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+F\+L\+A\+G\+S\+\_\+\+S\+H\+I\+F\+T)
\begin{DoxyCompactList}\small\item\em To select the upper 8 bits. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_a6c57183858046577704315da0c646e17}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+S\+I\+ZE}}(x)~(x.\+flags\+\_\+and\+\_\+size \& $\sim$\mbox{\hyperlink{records_8h_a240121903a439f00fd7db58a87dd6bb1}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+F\+L\+A\+G\+S\+\_\+\+B\+I\+T\+M\+A\+SK}})
\begin{DoxyCompactList}\small\item\em Get {\itshape size} from a \mbox{\hyperlink{structkv__record}{kv\+\_\+record}}. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_a422fd63a07942a1af4d47c76b34857c9}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+S\+I\+ZE}}(x,  y)
\begin{DoxyCompactList}\small\item\em Set {\itshape size} in a \mbox{\hyperlink{structkv__record}{kv\+\_\+record}}. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_a9e4e6c1a697e44bdc2a2f12dbbae4aaf}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+F\+L\+A\+GS}}(x)~((x.\+flags\+\_\+and\+\_\+size \& \mbox{\hyperlink{records_8h_a240121903a439f00fd7db58a87dd6bb1}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+F\+L\+A\+G\+S\+\_\+\+B\+I\+T\+M\+A\+SK}}) $>$$>$ \mbox{\hyperlink{records_8h_a07e560612b4c80586a58d887735f73f6}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+F\+L\+A\+G\+S\+\_\+\+S\+H\+I\+FT}})
\begin{DoxyCompactList}\small\item\em Get {\itshape flags} in a \mbox{\hyperlink{structkv__record}{kv\+\_\+record}}. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_a5202e03977dd0331402ecccf11df1646}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+F\+L\+A\+GS}}(x,  y)
\begin{DoxyCompactList}\small\item\em Set {\itshape flags} in a \mbox{\hyperlink{structkv__record}{kv\+\_\+record}}. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_a7e9564253d8dd8589f051ff1d665c47d}{R\+E\+C\+O\+R\+D\+\_\+\+C\+R\+E\+A\+TE}}(x,  y)~x $\ast$y = (x $\ast$)\mbox{\hyperlink{memory_8h_a8636b9008fa5840103c6ddf168c5dd61}{memory\+\_\+alloc}}(sizeof(x))
\begin{DoxyCompactList}\small\item\em Helper to instantiate a new record type. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{records_8h_ac222cde2a23fa625b7ffc74f886c685e}{R\+E\+C\+O\+R\+D\+\_\+\+A\+L\+L\+OC}}(x,  y)~y = (x $\ast$)\mbox{\hyperlink{memory_8h_a8636b9008fa5840103c6ddf168c5dd61}{memory\+\_\+alloc}}(sizeof(x))
\begin{DoxyCompactList}\small\item\em Helper to allocate a new record type. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}} \mbox{\hyperlink{records_8h_a6cdffbf88799d0a72d5f65baf32efc58}{Record\+\_\+ptbl}}
\begin{DoxyCompactList}\small\item\em Holds information relating to a bucket ({\itshape key}), including the number of pages allocated, as well as a pointer to those pages in memory. \end{DoxyCompactList}\item 
typedef struct \mbox{\hyperlink{structkv__record}{kv\+\_\+record}} \mbox{\hyperlink{records_8h_a6e24c63eab328d7401f7ea924b4b5a66}{Record\+\_\+kv}}
\begin{DoxyCompactList}\small\item\em Holds information for a key/value pair, including the bucket the value resides in, it\textquotesingle{}s {\itshape index} (offset) into the bucket (\mbox{\hyperlink{structptbl__record_acec45fcdf4427d3a1b62c84973d5f484}{ptbl\+\_\+record.\+m\+\_\+offset}} + {\itshape index}), in addition to the size of the value in bytes. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{records_8h_a118c356dd22b00a42d98dd7fde83d565}\label{records_8h_a118c356dd22b00a42d98dd7fde83d565}} 
typedef struct \mbox{\hyperlink{structdatabase__record}{database\+\_\+record}} \mbox{\hyperlink{records_8h_a118c356dd22b00a42d98dd7fde83d565}{Record\+\_\+database}}
\begin{DoxyCompactList}\small\item\em Holds the global state of the database. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Data structures (and macros) that comprise the database index. 



\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{records_8h_a80448b087f4397d78cb18e87a4c03875}\label{records_8h_a80448b087f4397d78cb18e87a4c03875}} 
\index{records.\+h@{records.\+h}!K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+B\+U\+C\+K\+ET@{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+B\+U\+C\+K\+ET}}
\index{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+B\+U\+C\+K\+ET@{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+B\+U\+C\+K\+ET}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+B\+U\+C\+K\+ET}{KV\_RECORD\_GET\_BUCKET}}
{\footnotesize\ttfamily \#define K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+B\+U\+C\+K\+ET(\begin{DoxyParamCaption}\item[{}]{x }\end{DoxyParamCaption})~(((x).bucket\+\_\+and\+\_\+index \& \mbox{\hyperlink{records_8h_a87994a627b1eb53ef23a3f2e0b412dd9}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+B\+I\+T\+M\+A\+SK}}) $>$$>$ \mbox{\hyperlink{records_8h_a0554ee6db70190ff5cfadd564a5dc340}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+S\+H\+I\+FT}})}



Get {\itshape bucket} from a \mbox{\hyperlink{structkv__record}{kv\+\_\+record}} pointer. 


\begin{DoxyParams}{Parameters}
{\em x} & \mbox{\hyperlink{structkv__record}{kv\+\_\+record}} \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{structkv__record_aa6e3c994316398afea8be6a05094f5b0}{kv\+\_\+record.\+bucket\+\_\+and\+\_\+index}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{records_8h_a9e4e6c1a697e44bdc2a2f12dbbae4aaf}\label{records_8h_a9e4e6c1a697e44bdc2a2f12dbbae4aaf}} 
\index{records.\+h@{records.\+h}!K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+F\+L\+A\+GS@{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+F\+L\+A\+GS}}
\index{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+F\+L\+A\+GS@{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+F\+L\+A\+GS}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+F\+L\+A\+GS}{KV\_RECORD\_GET\_FLAGS}}
{\footnotesize\ttfamily \#define K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+F\+L\+A\+GS(\begin{DoxyParamCaption}\item[{}]{x }\end{DoxyParamCaption})~((x.\+flags\+\_\+and\+\_\+size \& \mbox{\hyperlink{records_8h_a240121903a439f00fd7db58a87dd6bb1}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+F\+L\+A\+G\+S\+\_\+\+B\+I\+T\+M\+A\+SK}}) $>$$>$ \mbox{\hyperlink{records_8h_a07e560612b4c80586a58d887735f73f6}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+F\+L\+A\+G\+S\+\_\+\+S\+H\+I\+FT}})}



Get {\itshape flags} in a \mbox{\hyperlink{structkv__record}{kv\+\_\+record}}. 


\begin{DoxyParams}{Parameters}
{\em x} & \mbox{\hyperlink{structkv__record}{kv\+\_\+record}} ({\bfseries not} a pointer) \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{structkv__record_aeb53c0b3c86b47eaddb5ad8b83f6ed69}{kv\+\_\+record.\+flags\+\_\+and\+\_\+size}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{records_8h_a6889537ca98023db3031819f454673c5}\label{records_8h_a6889537ca98023db3031819f454673c5}} 
\index{records.\+h@{records.\+h}!K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+I\+N\+D\+EX@{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+I\+N\+D\+EX}}
\index{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+I\+N\+D\+EX@{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+I\+N\+D\+EX}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+I\+N\+D\+EX}{KV\_RECORD\_GET\_INDEX}}
{\footnotesize\ttfamily \#define K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+I\+N\+D\+EX(\begin{DoxyParamCaption}\item[{}]{x }\end{DoxyParamCaption})~((x).bucket\+\_\+and\+\_\+index \& $\sim$\mbox{\hyperlink{records_8h_a87994a627b1eb53ef23a3f2e0b412dd9}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+B\+I\+T\+M\+A\+SK}})}



Get {\itshape index} from a \mbox{\hyperlink{structkv__record}{kv\+\_\+record}} pointer. 


\begin{DoxyParams}{Parameters}
{\em x} & \mbox{\hyperlink{structkv__record}{kv\+\_\+record}} \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{structkv__record_aa6e3c994316398afea8be6a05094f5b0}{kv\+\_\+record.\+bucket\+\_\+and\+\_\+index}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{records_8h_a6c57183858046577704315da0c646e17}\label{records_8h_a6c57183858046577704315da0c646e17}} 
\index{records.\+h@{records.\+h}!K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+S\+I\+ZE@{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+S\+I\+ZE}}
\index{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+S\+I\+ZE@{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+S\+I\+ZE}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+S\+I\+ZE}{KV\_RECORD\_GET\_SIZE}}
{\footnotesize\ttfamily \#define K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+S\+I\+ZE(\begin{DoxyParamCaption}\item[{}]{x }\end{DoxyParamCaption})~(x.\+flags\+\_\+and\+\_\+size \& $\sim$\mbox{\hyperlink{records_8h_a240121903a439f00fd7db58a87dd6bb1}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+F\+L\+A\+G\+S\+\_\+\+B\+I\+T\+M\+A\+SK}})}



Get {\itshape size} from a \mbox{\hyperlink{structkv__record}{kv\+\_\+record}}. 


\begin{DoxyParams}{Parameters}
{\em x} & \mbox{\hyperlink{structkv__record}{kv\+\_\+record}} ({\bfseries not} a pointer) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Size of the value in bytes 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{structkv__record_aeb53c0b3c86b47eaddb5ad8b83f6ed69}{kv\+\_\+record.\+flags\+\_\+and\+\_\+size}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{records_8h_a18d200962bc69924d436b8e8c224c6fb}\label{records_8h_a18d200962bc69924d436b8e8c224c6fb}} 
\index{records.\+h@{records.\+h}!K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+B\+U\+C\+K\+ET@{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+B\+U\+C\+K\+ET}}
\index{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+B\+U\+C\+K\+ET@{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+B\+U\+C\+K\+ET}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+B\+U\+C\+K\+ET}{KV\_RECORD\_SET\_BUCKET}}
{\footnotesize\ttfamily \#define K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+B\+U\+C\+K\+ET(\begin{DoxyParamCaption}\item[{}]{x,  }\item[{}]{y }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}
x.bucket\_and\_index &= ~\mbox{\hyperlink{records_8h_a87994a627b1eb53ef23a3f2e0b412dd9}{KV\_RECORD\_BUCKET\_BITMASK}}; \(\backslash\)
    x.bucket\_and\_index |= ((\textcolor{keywordtype}{unsigned} long)(y & (\mbox{\hyperlink{records_8h_a87994a627b1eb53ef23a3f2e0b412dd9}{KV\_RECORD\_BUCKET\_BITMASK}} >> 
      \mbox{\hyperlink{records_8h_a0554ee6db70190ff5cfadd564a5dc340}{KV\_RECORD\_BUCKET\_SHIFT}})) << \mbox{\hyperlink{records_8h_a0554ee6db70190ff5cfadd564a5dc340}{KV\_RECORD\_BUCKET\_SHIFT}});
\end{DoxyCode}


Set {\itshape bucket} in a \mbox{\hyperlink{structkv__record}{kv\+\_\+record}}. 


\begin{DoxyParams}{Parameters}
{\em x} & \mbox{\hyperlink{structkv__record}{kv\+\_\+record}} ({\bfseries not} a pointer) \\
\hline
{\em y} & bucket $0 \leq y \leq 63$ \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{structkv__record_aa6e3c994316398afea8be6a05094f5b0}{kv\+\_\+record.\+bucket\+\_\+and\+\_\+index}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{records_8h_a5202e03977dd0331402ecccf11df1646}\label{records_8h_a5202e03977dd0331402ecccf11df1646}} 
\index{records.\+h@{records.\+h}!K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+F\+L\+A\+GS@{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+F\+L\+A\+GS}}
\index{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+F\+L\+A\+GS@{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+F\+L\+A\+GS}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+F\+L\+A\+GS}{KV\_RECORD\_SET\_FLAGS}}
{\footnotesize\ttfamily \#define K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+F\+L\+A\+GS(\begin{DoxyParamCaption}\item[{}]{x,  }\item[{}]{y }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}
x.flags\_and\_size &= ~\mbox{\hyperlink{records_8h_a240121903a439f00fd7db58a87dd6bb1}{KV\_RECORD\_FLAGS\_BITMASK}}; \(\backslash\)
    x.flags\_and\_size |= ((\textcolor{keywordtype}{unsigned} long)(y & (\mbox{\hyperlink{records_8h_a240121903a439f00fd7db58a87dd6bb1}{KV\_RECORD\_FLAGS\_BITMASK}} >> 
      \mbox{\hyperlink{records_8h_a07e560612b4c80586a58d887735f73f6}{KV\_RECORD\_FLAGS\_SHIFT}})) << \mbox{\hyperlink{records_8h_a07e560612b4c80586a58d887735f73f6}{KV\_RECORD\_FLAGS\_SHIFT}});
\end{DoxyCode}


Set {\itshape flags} in a \mbox{\hyperlink{structkv__record}{kv\+\_\+record}}. 


\begin{DoxyParams}{Parameters}
{\em x} & \mbox{\hyperlink{structkv__record}{kv\+\_\+record}} ({\bfseries not} a pointer) \\
\hline
{\em y} & flags \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{structkv__record_aeb53c0b3c86b47eaddb5ad8b83f6ed69}{kv\+\_\+record.\+flags\+\_\+and\+\_\+size}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{records_8h_adae07bcfb40a4d18850231371ec6204e}\label{records_8h_adae07bcfb40a4d18850231371ec6204e}} 
\index{records.\+h@{records.\+h}!K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+I\+N\+D\+EX@{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+I\+N\+D\+EX}}
\index{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+I\+N\+D\+EX@{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+I\+N\+D\+EX}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+I\+N\+D\+EX}{KV\_RECORD\_SET\_INDEX}}
{\footnotesize\ttfamily \#define K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+I\+N\+D\+EX(\begin{DoxyParamCaption}\item[{}]{x,  }\item[{}]{y }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}
x.bucket\_and\_index &= \mbox{\hyperlink{records_8h_a87994a627b1eb53ef23a3f2e0b412dd9}{KV\_RECORD\_BUCKET\_BITMASK}}; \(\backslash\)
    x.bucket\_and\_index |= (y & ~\mbox{\hyperlink{records_8h_a87994a627b1eb53ef23a3f2e0b412dd9}{KV\_RECORD\_BUCKET\_BITMASK}});
\end{DoxyCode}


Set {\itshape index} in a \mbox{\hyperlink{structkv__record}{kv\+\_\+record}}. 


\begin{DoxyParams}{Parameters}
{\em x} & \mbox{\hyperlink{structkv__record}{kv\+\_\+record}} ({\bfseries not} a pointer) \\
\hline
{\em y} & index \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{structkv__record_aa6e3c994316398afea8be6a05094f5b0}{kv\+\_\+record.\+bucket\+\_\+and\+\_\+index}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{records_8h_a422fd63a07942a1af4d47c76b34857c9}\label{records_8h_a422fd63a07942a1af4d47c76b34857c9}} 
\index{records.\+h@{records.\+h}!K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+S\+I\+ZE@{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+S\+I\+ZE}}
\index{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+S\+I\+ZE@{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+S\+I\+ZE}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+S\+I\+ZE}{KV\_RECORD\_SET\_SIZE}}
{\footnotesize\ttfamily \#define K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+S\+I\+ZE(\begin{DoxyParamCaption}\item[{}]{x,  }\item[{}]{y }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}
x.flags\_and\_size &= \mbox{\hyperlink{records_8h_a240121903a439f00fd7db58a87dd6bb1}{KV\_RECORD\_FLAGS\_BITMASK}}; \(\backslash\)
    x.flags\_and\_size |= (y & ~\mbox{\hyperlink{records_8h_a240121903a439f00fd7db58a87dd6bb1}{KV\_RECORD\_FLAGS\_BITMASK}});
\end{DoxyCode}


Set {\itshape size} in a \mbox{\hyperlink{structkv__record}{kv\+\_\+record}}. 


\begin{DoxyParams}{Parameters}
{\em x} & \mbox{\hyperlink{structkv__record}{kv\+\_\+record}} ({\bfseries not} a pointer) \\
\hline
{\em y} & size \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{structkv__record_aeb53c0b3c86b47eaddb5ad8b83f6ed69}{kv\+\_\+record.\+flags\+\_\+and\+\_\+size}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{records_8h_ab49380468cb45feb3cc044c7337b5e7c}\label{records_8h_ab49380468cb45feb3cc044c7337b5e7c}} 
\index{records.\+h@{records.\+h}!P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+W\+O\+R\+D\+\_\+\+S\+I\+ZE@{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+W\+O\+R\+D\+\_\+\+S\+I\+ZE}}
\index{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+W\+O\+R\+D\+\_\+\+S\+I\+ZE@{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+W\+O\+R\+D\+\_\+\+S\+I\+ZE}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+W\+O\+R\+D\+\_\+\+S\+I\+ZE}{PTBL\_CALC\_BUCKET\_WORD\_SIZE}}
{\footnotesize\ttfamily \#define P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+W\+O\+R\+D\+\_\+\+S\+I\+ZE(\begin{DoxyParamCaption}\item[{}]{x }\end{DoxyParamCaption})~(16 $<$$<$ x)}



Calculate max value size for bucket {\itshape x}. 

Computes the maximum number of bytes that a value in a page in bucket {\itshape x} can occupy

\tabulinesep=1mm
\begin{longtabu} spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Bucket  }&\textbf{ word size   }\\\cline{1-2}
\endfirsthead
\hline
\endfoot
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Bucket  }&\textbf{ word size   }\\\cline{1-2}
\endhead
0  &16B   \\\cline{1-2}
1  &32B   \\\cline{1-2}
2  &64B   \\\cline{1-2}
3  &128B   \\\cline{1-2}
{\itshape x}  &(1 $<$$<$ (4 + {\itshape x}))   \\\cline{1-2}
63  &147\+EB   \\\cline{1-2}
\end{longtabu}



\begin{DoxyParams}{Parameters}
{\em x} & bucket $0 \leq x \leq 63$ \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
max value length in bytes 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}} 

\mbox{\hyperlink{structkv__record_aa6e3c994316398afea8be6a05094f5b0}{kv\+\_\+record.\+bucket\+\_\+and\+\_\+index}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{records_8h_a46f2b82d234b9778310024626d19fb03}\label{records_8h_a46f2b82d234b9778310024626d19fb03}} 
\index{records.\+h@{records.\+h}!P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+B\+I\+TS@{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+B\+I\+TS}}
\index{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+B\+I\+TS@{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+B\+I\+TS}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+B\+I\+TS}{PTBL\_CALC\_PAGE\_USAGE\_BITS}}
{\footnotesize\ttfamily \#define P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+B\+I\+TS(\begin{DoxyParamCaption}\item[{}]{x }\end{DoxyParamCaption})~((x $<$ 8) ? (256 $>$$>$ x) \+: 1)}



Calculate bits used by one page\textquotesingle{}s bookkeeping. 

Computes the number of bits it would take to represent the usage status of every value inside a page of bucket {\itshape x} 

\tabulinesep=1mm
\begin{longtabu} spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Bucket  }&\textbf{ bits   }\\\cline{1-2}
\endfirsthead
\hline
\endfoot
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Bucket  }&\textbf{ bits   }\\\cline{1-2}
\endhead
0  &256   \\\cline{1-2}
1  &128   \\\cline{1-2}
2  &64   \\\cline{1-2}
{\itshape x}  &(256 $>$$>$ {\itshape x})   \\\cline{1-2}
8  &\multirow{3}{\linewidth}{1   }\\\cline{1-1}
9   &\multicolumn{1}{c|}{}\\\cline{1-1}
{\itshape x}   &\multicolumn{1}{c|}{}\\\cline{1-2}
\end{longtabu}



\begin{DoxyParams}{Parameters}
{\em x} & bucket $0 \leq x \leq 63$ \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
number of bits 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{records_8h_a1cd95048f707ae0b6b39835a9a375f80}{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+B\+Y\+T\+E\+S()}} 

\mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{records_8h_a1cd95048f707ae0b6b39835a9a375f80}\label{records_8h_a1cd95048f707ae0b6b39835a9a375f80}} 
\index{records.\+h@{records.\+h}!P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+B\+Y\+T\+ES@{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+B\+Y\+T\+ES}}
\index{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+B\+Y\+T\+ES@{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+B\+Y\+T\+ES}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+B\+Y\+T\+ES}{PTBL\_CALC\_PAGE\_USAGE\_BYTES}}
{\footnotesize\ttfamily \#define P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+B\+Y\+T\+ES(\begin{DoxyParamCaption}\item[{}]{x }\end{DoxyParamCaption})~((x $<$ 5) ? (32 $>$$>$ x) \+: 1)}



Calculate bytes used by one pages bookkeeping. 

Computes the number of bytes it would take to represent the usage status of every value inside a page of bucket {\itshape x} 

\tabulinesep=1mm
\begin{longtabu} spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Bucket  }&\textbf{ bytes   }\\\cline{1-2}
\endfirsthead
\hline
\endfoot
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Bucket  }&\textbf{ bytes   }\\\cline{1-2}
\endhead
0  &32   \\\cline{1-2}
1  &16   \\\cline{1-2}
2  &8   \\\cline{1-2}
{\itshape x}  &(32 $>$$>$ {\itshape x})   \\\cline{1-2}
5  &\multirow{3}{\linewidth}{1   }\\\cline{1-1}
6   &\multicolumn{1}{c|}{}\\\cline{1-1}
{\itshape x}   &\multicolumn{1}{c|}{}\\\cline{1-2}
\end{longtabu}



\begin{DoxyParams}{Parameters}
{\em x} & bucket $0 \leq x \leq 63$ \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
number of bytes 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{records_8h_a46f2b82d234b9778310024626d19fb03}{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+B\+I\+T\+S()}} 

\mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{records_8h_abcc7cb7701a27ad791d23f88ce3fa2c3}\label{records_8h_abcc7cb7701a27ad791d23f88ce3fa2c3}} 
\index{records.\+h@{records.\+h}!P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+L\+E\+N\+G\+TH@{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+L\+E\+N\+G\+TH}}
\index{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+L\+E\+N\+G\+TH@{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+L\+E\+N\+G\+TH}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+L\+E\+N\+G\+TH}{PTBL\_CALC\_PAGE\_USAGE\_LENGTH}}
{\footnotesize\ttfamily \#define P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+L\+E\+N\+G\+TH(\begin{DoxyParamCaption}\item[{}]{x,  }\item[{}]{y }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}
((x <= 5) ?\(\backslash\)
        (\mbox{\hyperlink{records_8h_a1cd95048f707ae0b6b39835a9a375f80}{PTBL\_CALC\_PAGE\_USAGE\_BYTES}}(x) * y) :\(\backslash\)
        (((\mbox{\hyperlink{records_8h_a46f2b82d234b9778310024626d19fb03}{PTBL\_CALC\_PAGE\_USAGE\_BITS}}(x) * y) / 8) + (((
      \mbox{\hyperlink{records_8h_a46f2b82d234b9778310024626d19fb03}{PTBL\_CALC\_PAGE\_USAGE\_BITS}}(x) * y) % 8) > 0 ? 1 : 0)))
\end{DoxyCode}


Calculate bytes used by multiple pages bookkeeping. 

Computes the number of bytes it would take to represent the usage status of every value inside {\itshape y} pages of bucket {\itshape x} 


\begin{DoxyParams}{Parameters}
{\em x} & bucket \\
\hline
{\em y} & number of pages \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
number of bytes 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{records_8h_a1cd95048f707ae0b6b39835a9a375f80}{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+B\+Y\+T\+E\+S()}} 

\mbox{\hyperlink{records_8h_a46f2b82d234b9778310024626d19fb03}{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+B\+I\+T\+S()}} 

\mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{records_8h_a8e35710be790a9afaebb611c8961e902}\label{records_8h_a8e35710be790a9afaebb611c8961e902}} 
\index{records.\+h@{records.\+h}!P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+K\+EY@{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+K\+EY}}
\index{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+K\+EY@{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+K\+EY}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+K\+EY}{PTBL\_RECORD\_GET\_KEY}}
{\footnotesize\ttfamily \#define P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+K\+EY(\begin{DoxyParamCaption}\item[{}]{x }\end{DoxyParamCaption})~(((x.\+key\+\_\+high\+\_\+and\+\_\+page\+\_\+count \& \mbox{\hyperlink{records_8h_a4307b32adc58d4d466f48cb0ca739624}{P\+T\+B\+L\+\_\+\+K\+E\+Y\+\_\+\+B\+I\+T\+M\+A\+SK}}) $>$$>$ \mbox{\hyperlink{records_8h_af847dfd35edd975e85b6a90d795f6f34}{P\+T\+B\+L\+\_\+\+K\+E\+Y\+\_\+\+H\+I\+G\+H\+\_\+\+S\+H\+I\+FT}}) $\vert$ ((x.\+key\+\_\+low\+\_\+and\+\_\+offset \& \mbox{\hyperlink{records_8h_a4307b32adc58d4d466f48cb0ca739624}{P\+T\+B\+L\+\_\+\+K\+E\+Y\+\_\+\+B\+I\+T\+M\+A\+SK}}) $>$$>$ \mbox{\hyperlink{records_8h_a4d90c2cd7e45496cdae365da72106579}{P\+T\+B\+L\+\_\+\+K\+E\+Y\+\_\+\+L\+O\+W\+\_\+\+S\+H\+I\+FT}}))}



Get {\itshape key} from a \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}}. 

Note that {\itshape key} is the bucket number.


\begin{DoxyParams}{Parameters}
{\em x} & \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}} ({\bfseries not} a pointer) \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{structptbl__record_a34c3fcdd6600f21e6708955bc93195d6}{ptbl\+\_\+record.\+key\+\_\+high\+\_\+and\+\_\+page\+\_\+count}} 

\mbox{\hyperlink{structptbl__record_a50bac56284cd6f4e527a322e07d28772}{ptbl\+\_\+record.\+key\+\_\+low\+\_\+and\+\_\+offset}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{records_8h_ac9930081aa81ff02727b678b745d0316}\label{records_8h_ac9930081aa81ff02727b678b745d0316}} 
\index{records.\+h@{records.\+h}!P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+O\+F\+F\+S\+ET@{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+O\+F\+F\+S\+ET}}
\index{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+O\+F\+F\+S\+ET@{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+O\+F\+F\+S\+ET}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+O\+F\+F\+S\+ET}{PTBL\_RECORD\_GET\_OFFSET}}
{\footnotesize\ttfamily \#define P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+O\+F\+F\+S\+ET(\begin{DoxyParamCaption}\item[{}]{x }\end{DoxyParamCaption})~(x.\+key\+\_\+low\+\_\+and\+\_\+offset \& $\sim$\mbox{\hyperlink{records_8h_a4307b32adc58d4d466f48cb0ca739624}{P\+T\+B\+L\+\_\+\+K\+E\+Y\+\_\+\+B\+I\+T\+M\+A\+SK}})}



Get {\itshape offset} from a \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}}. 


\begin{DoxyParams}{Parameters}
{\em x} & \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}} ({\bfseries not} a pointer) \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{structptbl__record_a50bac56284cd6f4e527a322e07d28772}{ptbl\+\_\+record.\+key\+\_\+low\+\_\+and\+\_\+offset}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{records_8h_a647e71e3027f3c991be8fcd4f60bf2d2}\label{records_8h_a647e71e3027f3c991be8fcd4f60bf2d2}} 
\index{records.\+h@{records.\+h}!P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+P\+A\+G\+E\+\_\+\+C\+O\+U\+NT@{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+P\+A\+G\+E\+\_\+\+C\+O\+U\+NT}}
\index{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+P\+A\+G\+E\+\_\+\+C\+O\+U\+NT@{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+P\+A\+G\+E\+\_\+\+C\+O\+U\+NT}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+P\+A\+G\+E\+\_\+\+C\+O\+U\+NT}{PTBL\_RECORD\_GET\_PAGE\_COUNT}}
{\footnotesize\ttfamily \#define P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+P\+A\+G\+E\+\_\+\+C\+O\+U\+NT(\begin{DoxyParamCaption}\item[{}]{x }\end{DoxyParamCaption})~(x.\+key\+\_\+high\+\_\+and\+\_\+page\+\_\+count \& $\sim$\mbox{\hyperlink{records_8h_a4307b32adc58d4d466f48cb0ca739624}{P\+T\+B\+L\+\_\+\+K\+E\+Y\+\_\+\+B\+I\+T\+M\+A\+SK}})}



Get {\itshape page\+\_\+count} from a \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}}. 


\begin{DoxyParams}{Parameters}
{\em x} & \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}} ({\bfseries not} a pointer) \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{structptbl__record_a34c3fcdd6600f21e6708955bc93195d6}{ptbl\+\_\+record.\+key\+\_\+high\+\_\+and\+\_\+page\+\_\+count}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{records_8h_ab1ba341a9a6bebf5f1c883876fe6943a}\label{records_8h_ab1ba341a9a6bebf5f1c883876fe6943a}} 
\index{records.\+h@{records.\+h}!P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+F\+R\+EE@{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+F\+R\+EE}}
\index{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+F\+R\+EE@{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+F\+R\+EE}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+F\+R\+EE}{PTBL\_RECORD\_PAGE\_USAGE\_FREE}}
{\footnotesize\ttfamily \#define P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+P\+A\+G\+E\+\_\+\+U\+S\+A\+G\+E\+\_\+\+F\+R\+EE(\begin{DoxyParamCaption}\item[{}]{x,  }\item[{}]{y,  }\item[{}]{z }\end{DoxyParamCaption})~(x)-\/$>$ptbl\+\_\+record\+\_\+tbl\mbox{[}y\mbox{]}.page\+\_\+usage\mbox{[}z / 8\mbox{]} \&= $\sim$((unsigned char)1 $<$$<$ (z \% 8));}



Mark page number {\itshape z} as freed in \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}} at index {\itshape y} of \mbox{\hyperlink{structdatabase__record}{database\+\_\+record}} {\itshape x}. 


\begin{DoxyParams}{Parameters}
{\em x} & \mbox{\hyperlink{structdatabase__record}{database\+\_\+record}} (pointer) \\
\hline
{\em y} & Index into the ptbl\+\_\+record\+\_\+tbl corresponding to the page\textquotesingle{}s bucket \\
\hline
{\em z} & page number (\mbox{\hyperlink{structkv__record_aa6e3c994316398afea8be6a05094f5b0}{kv\+\_\+record.\+bucket\+\_\+and\+\_\+index}}) \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{records_8h_ad9320ecf8a9235a6c89f644e7fbc9b38}\label{records_8h_ad9320ecf8a9235a6c89f644e7fbc9b38}} 
\index{records.\+h@{records.\+h}!P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+K\+EY@{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+K\+EY}}
\index{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+K\+EY@{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+K\+EY}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+K\+EY}{PTBL\_RECORD\_SET\_KEY}}
{\footnotesize\ttfamily \#define P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+K\+EY(\begin{DoxyParamCaption}\item[{}]{x,  }\item[{}]{y }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}
x.key\_high\_and\_page\_count &= ~\mbox{\hyperlink{records_8h_a4307b32adc58d4d466f48cb0ca739624}{PTBL\_KEY\_BITMASK}}; \(\backslash\)
    x.key\_low\_and\_offset &= ~\mbox{\hyperlink{records_8h_a4307b32adc58d4d466f48cb0ca739624}{PTBL\_KEY\_BITMASK}}; \(\backslash\)
    x.key\_high\_and\_page\_count |= ((y & \mbox{\hyperlink{records_8h_a17dbe31d1cee6f44a3bad7897ef979bf}{PTBL\_KEY\_HIGH\_BITMASK}}) << 
      \mbox{\hyperlink{records_8h_af847dfd35edd975e85b6a90d795f6f34}{PTBL\_KEY\_HIGH\_SHIFT}}); \(\backslash\)
    x.key\_low\_and\_offset |= ((y & \mbox{\hyperlink{records_8h_af01d8b6e79fbdd4889e8fc15c72c153b}{PTBL\_KEY\_LOW\_BITMASK}}) << 
      \mbox{\hyperlink{records_8h_a4d90c2cd7e45496cdae365da72106579}{PTBL\_KEY\_LOW\_SHIFT}});
\end{DoxyCode}


Set {\itshape key} in a \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}}. 

Note that {\itshape key} is the bucket number.

This macro is only to be called once, upon initialization of the record. Once set, the {\itshape key} (bucket) is expected to {\bfseries never} change.


\begin{DoxyParams}{Parameters}
{\em x} & \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}} ({\bfseries not} a pointer) \\
\hline
{\em y} & bucket $0 \leq y \leq 63$ \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{structptbl__record_a34c3fcdd6600f21e6708955bc93195d6}{ptbl\+\_\+record.\+key\+\_\+high\+\_\+and\+\_\+page\+\_\+count}} 

\mbox{\hyperlink{structptbl__record_a50bac56284cd6f4e527a322e07d28772}{ptbl\+\_\+record.\+key\+\_\+low\+\_\+and\+\_\+offset}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{records_8h_afdc13ecd37c36af6dc8f095c5575cc57}\label{records_8h_afdc13ecd37c36af6dc8f095c5575cc57}} 
\index{records.\+h@{records.\+h}!P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+O\+F\+F\+S\+ET@{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+O\+F\+F\+S\+ET}}
\index{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+O\+F\+F\+S\+ET@{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+O\+F\+F\+S\+ET}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+O\+F\+F\+S\+ET}{PTBL\_RECORD\_SET\_OFFSET}}
{\footnotesize\ttfamily \#define P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+O\+F\+F\+S\+ET(\begin{DoxyParamCaption}\item[{}]{x,  }\item[{}]{y }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}
x.key\_low\_and\_offset &= \mbox{\hyperlink{records_8h_a4307b32adc58d4d466f48cb0ca739624}{PTBL\_KEY\_BITMASK}}; \(\backslash\)
    x.key\_low\_and\_offset |= ((\textcolor{keywordtype}{unsigned} int)y & ~\mbox{\hyperlink{records_8h_a4307b32adc58d4d466f48cb0ca739624}{PTBL\_KEY\_BITMASK}});
\end{DoxyCode}


Set {\itshape offset} in a \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}}. 


\begin{DoxyParams}{Parameters}
{\em x} & \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}} ({\bfseries not} a pointer) \\
\hline
{\em y} & new {\itshape offset} (unsigned int) \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{structptbl__record_a50bac56284cd6f4e527a322e07d28772}{ptbl\+\_\+record.\+key\+\_\+low\+\_\+and\+\_\+offset}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{records_8h_a0fcde3739a73415bcfbc2812ad7923c5}\label{records_8h_a0fcde3739a73415bcfbc2812ad7923c5}} 
\index{records.\+h@{records.\+h}!P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+P\+A\+G\+E\+\_\+\+C\+O\+U\+NT@{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+P\+A\+G\+E\+\_\+\+C\+O\+U\+NT}}
\index{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+P\+A\+G\+E\+\_\+\+C\+O\+U\+NT@{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+P\+A\+G\+E\+\_\+\+C\+O\+U\+NT}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+P\+A\+G\+E\+\_\+\+C\+O\+U\+NT}{PTBL\_RECORD\_SET\_PAGE\_COUNT}}
{\footnotesize\ttfamily \#define P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+S\+E\+T\+\_\+\+P\+A\+G\+E\+\_\+\+C\+O\+U\+NT(\begin{DoxyParamCaption}\item[{}]{x,  }\item[{}]{y }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}
x.key\_high\_and\_page\_count &= \mbox{\hyperlink{records_8h_a4307b32adc58d4d466f48cb0ca739624}{PTBL\_KEY\_BITMASK}}; \(\backslash\)
    x.key\_high\_and\_page\_count |= ((\textcolor{keywordtype}{unsigned} int)y & ~\mbox{\hyperlink{records_8h_a4307b32adc58d4d466f48cb0ca739624}{PTBL\_KEY\_BITMASK}});
\end{DoxyCode}


Set {\itshape page\+\_\+count} in a \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}}. 


\begin{DoxyParams}{Parameters}
{\em x} & \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}} ({\bfseries not} a pointer) \\
\hline
{\em y} & new {\itshape page\+\_\+count} (unsigned long) \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{structptbl__record_a34c3fcdd6600f21e6708955bc93195d6}{ptbl\+\_\+record.\+key\+\_\+high\+\_\+and\+\_\+page\+\_\+count}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{records_8h_af3d07908f3a0accb47c36c0c34b53f40}\label{records_8h_af3d07908f3a0accb47c36c0c34b53f40}} 
\index{records.\+h@{records.\+h}!P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+V\+A\+L\+U\+E\+\_\+\+P\+TR@{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+V\+A\+L\+U\+E\+\_\+\+P\+TR}}
\index{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+V\+A\+L\+U\+E\+\_\+\+P\+TR@{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+V\+A\+L\+U\+E\+\_\+\+P\+TR}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+V\+A\+L\+U\+E\+\_\+\+P\+TR}{PTBL\_RECORD\_VALUE\_PTR}}
{\footnotesize\ttfamily \#define P\+T\+B\+L\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+V\+A\+L\+U\+E\+\_\+\+P\+TR(\begin{DoxyParamCaption}\item[{}]{x,  }\item[{}]{y,  }\item[{}]{z }\end{DoxyParamCaption})~(unsigned char $\ast$)(x-\/$>$ptbl\+\_\+record\+\_\+tbl\mbox{[}y\mbox{]}.m\+\_\+offset + \mbox{\hyperlink{records_8h_a6889537ca98023db3031819f454673c5}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+I\+N\+D\+EX}}(z) $\ast$ \mbox{\hyperlink{records_8h_ab49380468cb45feb3cc044c7337b5e7c}{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+W\+O\+R\+D\+\_\+\+S\+I\+ZE}}(\mbox{\hyperlink{records_8h_a80448b087f4397d78cb18e87a4c03875}{K\+V\+\_\+\+R\+E\+C\+O\+R\+D\+\_\+\+G\+E\+T\+\_\+\+B\+U\+C\+K\+ET}}(z)))}



Calculate the address in memory that a given \mbox{\hyperlink{structkv__record}{kv\+\_\+record}} value resides at. 


\begin{DoxyParams}{Parameters}
{\em x} & \mbox{\hyperlink{structdatabase__record}{database\+\_\+record}} (pointer) \\
\hline
{\em y} & The \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}} for the bucket that \mbox{\hyperlink{structkv__record}{kv\+\_\+record}} {\itshape y} lives within ({\bfseries is} a pointer) \\
\hline
{\em z} & The \mbox{\hyperlink{structkv__record}{kv\+\_\+record}} \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{records_8h_ac222cde2a23fa625b7ffc74f886c685e}\label{records_8h_ac222cde2a23fa625b7ffc74f886c685e}} 
\index{records.\+h@{records.\+h}!R\+E\+C\+O\+R\+D\+\_\+\+A\+L\+L\+OC@{R\+E\+C\+O\+R\+D\+\_\+\+A\+L\+L\+OC}}
\index{R\+E\+C\+O\+R\+D\+\_\+\+A\+L\+L\+OC@{R\+E\+C\+O\+R\+D\+\_\+\+A\+L\+L\+OC}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{R\+E\+C\+O\+R\+D\+\_\+\+A\+L\+L\+OC}{RECORD\_ALLOC}}
{\footnotesize\ttfamily \#define R\+E\+C\+O\+R\+D\+\_\+\+A\+L\+L\+OC(\begin{DoxyParamCaption}\item[{}]{x,  }\item[{}]{y }\end{DoxyParamCaption})~y = (x $\ast$)\mbox{\hyperlink{memory_8h_a8636b9008fa5840103c6ddf168c5dd61}{memory\+\_\+alloc}}(sizeof(x))}



Helper to allocate a new record type. 

This will only allocate {\itshape sizeof(x)} bytes, and assign it to {\itshape y}. It does not create a new variable named {\itshape y}.


\begin{DoxyParams}{Parameters}
{\em x} & Record type \\
\hline
{\em y} & Variable name \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{records_8h_a7e9564253d8dd8589f051ff1d665c47d}\label{records_8h_a7e9564253d8dd8589f051ff1d665c47d}} 
\index{records.\+h@{records.\+h}!R\+E\+C\+O\+R\+D\+\_\+\+C\+R\+E\+A\+TE@{R\+E\+C\+O\+R\+D\+\_\+\+C\+R\+E\+A\+TE}}
\index{R\+E\+C\+O\+R\+D\+\_\+\+C\+R\+E\+A\+TE@{R\+E\+C\+O\+R\+D\+\_\+\+C\+R\+E\+A\+TE}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{R\+E\+C\+O\+R\+D\+\_\+\+C\+R\+E\+A\+TE}{RECORD\_CREATE}}
{\footnotesize\ttfamily \#define R\+E\+C\+O\+R\+D\+\_\+\+C\+R\+E\+A\+TE(\begin{DoxyParamCaption}\item[{}]{x,  }\item[{}]{y }\end{DoxyParamCaption})~x $\ast$y = (x $\ast$)\mbox{\hyperlink{memory_8h_a8636b9008fa5840103c6ddf168c5dd61}{memory\+\_\+alloc}}(sizeof(x))}



Helper to instantiate a new record type. 

This will create a new variable, in addition to allocating space for it.


\begin{DoxyParams}{Parameters}
{\em x} & Record type \\
\hline
{\em y} & Variable name \\
\hline
\end{DoxyParams}


\subsection{Typedef Documentation}
\mbox{\Hypertarget{records_8h_a6e24c63eab328d7401f7ea924b4b5a66}\label{records_8h_a6e24c63eab328d7401f7ea924b4b5a66}} 
\index{records.\+h@{records.\+h}!Record\+\_\+kv@{Record\+\_\+kv}}
\index{Record\+\_\+kv@{Record\+\_\+kv}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{Record\+\_\+kv}{Record\_kv}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{structkv__record}{kv\+\_\+record}}  \mbox{\hyperlink{records_8h_a6e24c63eab328d7401f7ea924b4b5a66}{Record\+\_\+kv}}}



Holds information for a key/value pair, including the bucket the value resides in, it\textquotesingle{}s {\itshape index} (offset) into the bucket (\mbox{\hyperlink{structptbl__record_acec45fcdf4427d3a1b62c84973d5f484}{ptbl\+\_\+record.\+m\+\_\+offset}} + {\itshape index}), in addition to the size of the value in bytes. 

This record has four composed values, which are encoded using the bits of {\itshape flags\+\_\+and\+\_\+size} and {\itshape bucket\+\_\+and\+\_\+index} and require a macro to either get or set them.

The composed values are\+:
\begin{DoxyItemize}
\item {\itshape flags} -\/ The data type of the KV
\item {\itshape size} -\/ The size of the value in bytes
\item {\itshape bucket} -\/ Which bucket (\mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}}) the page that holds this value resides in
\item {\itshape index} -\/ Used to determine the offset into the pages of bucket that this value starts at (value = \mbox{\hyperlink{structptbl__record_acec45fcdf4427d3a1b62c84973d5f484}{ptbl\+\_\+record.\+m\+\_\+offset}} + index $\ast$ \mbox{\hyperlink{records_8h_ab49380468cb45feb3cc044c7337b5e7c}{P\+T\+B\+L\+\_\+\+C\+A\+L\+C\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+W\+O\+R\+D\+\_\+\+S\+I\+Z\+E(bucket)}}) 
\end{DoxyItemize}\mbox{\Hypertarget{records_8h_a6cdffbf88799d0a72d5f65baf32efc58}\label{records_8h_a6cdffbf88799d0a72d5f65baf32efc58}} 
\index{records.\+h@{records.\+h}!Record\+\_\+ptbl@{Record\+\_\+ptbl}}
\index{Record\+\_\+ptbl@{Record\+\_\+ptbl}!records.\+h@{records.\+h}}
\subsubsection{\texorpdfstring{Record\+\_\+ptbl}{Record\_ptbl}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{structptbl__record}{ptbl\+\_\+record}}  \mbox{\hyperlink{records_8h_a6cdffbf88799d0a72d5f65baf32efc58}{Record\+\_\+ptbl}}}



Holds information relating to a bucket ({\itshape key}), including the number of pages allocated, as well as a pointer to those pages in memory. 

This record has three composed values, which are encoded using the bits of {\itshape key\+\_\+high\+\_\+and\+\_\+page\+\_\+count} and {\itshape key\+\_\+low\+\_\+and\+\_\+offset} and require a macro to either get or set them.

The composed values are\+:
\begin{DoxyItemize}
\item {\itshape key} -\/ bucket
\item {\itshape page\+\_\+count} -\/ Number of pages currently allocated
\item {\itshape offset} -\/ ({\bfseries disk-\/only}) An offset to the start of the page region 
\end{DoxyItemize}